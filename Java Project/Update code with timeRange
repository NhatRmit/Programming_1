import java.io.*;
import java.util.*;
import java.util.regex.*;
import java.util.stream.Collectors;
import java.time.*;
import java.time.format.DateTimeFormatter;
import java.util.Scanner;

public class App {
    public static void main(String[] args) throws Exception {
        String path = "src/covid-data.csv";
        String l = "";
        ArrayList<String> list = new ArrayList<>();
        ArrayList<String> data = new ArrayList<>();
        ArrayList<String> timerange = new ArrayList<>();
        ArrayList<String> area = new ArrayList<>();

        String[] country = { "Brunei" };
        LocalDate startDate = dateInput("12/1/2020");
        LocalDate endDate = dateInput("12/30/2020");

        List<LocalDate> listOfDates = startDate.datesUntil(endDate.plusDays(1)).collect(Collectors.toList());

        String[] time = new String[listOfDates.size()];

        DateTimeFormatter format = DateTimeFormatter.ofPattern("MM/d/yyyy");
        for (int i = 0; i < time.length; i++) {
            time[i] = (listOfDates.get(i)).format(format);
        }

        try {
            BufferedReader br = new BufferedReader(new FileReader(path));
            while ((l = br.readLine()) != null) {
                list.add(l);
            }

            System.out.println(list.get(0));

            for (String e : list) {
                for (int i = 0; i < time.length; i++) {
                    for (int j = 0; j < country.length; j++) {
                        if (isContain(e, time[i]) == true && isContain(e, country[j]) == true) {
                            data.add(e);
                            timerange.add(time[i]);
                            area.add(country[j]);
                        }
                    }
                }
            }

            int num_of_group = 3;
            int qty_days = timerange.size() / num_of_group;
            int checkdays = timerange.size() % num_of_group;

            System.out.println("total days " + timerange.size());
            System.out.println("quantity of days " + qty_days);
            System.out.println("check days " + checkdays);

            if (checkdays == 0) {
                List<List<String>> dataList = new ArrayList<List<String>>();
                for (int i = 1; i <= num_of_group; i++) {
                    List<String> tempList = new ArrayList<String>();
                    dataList.add(tempList);
                }
                for (int i = 0; i < num_of_group; i++) {
                    int value = i * qty_days;
                    for (int j = 1; j <= qty_days; j++) {
                        (dataList.get(i)).add(timerange.get((j - 1) + value));
                    }
                }
                for (List<String> s : dataList) {
                    System.out.println(s);
                }
            }

            if (checkdays == 1) {
                List<List<String>> dataList = new ArrayList<List<String>>();
                for (int i = 1; i <= num_of_group; i++) {
                    List<String> tempList = new ArrayList<String>();
                    dataList.add(tempList);
                }
                for (int i = 0; i < num_of_group; i++) {
                    int value = i * qty_days;
                    for (int j = 1; j <= qty_days; j++) {
                        (dataList.get(i)).add(timerange.get((j - 1) + value));
                    }
                }
                (dataList.get(num_of_group - 1)).add(timerange.get(timerange.size() - 1));
                for (List<String> s : dataList) {
                    System.out.println(s);
                }
            }

            if (checkdays == 2) {
                List<List<String>> dataList = new ArrayList<List<String>>();
                for (int i = 1; i <= num_of_group; i++) {
                    List<String> tempList = new ArrayList<String>();
                    dataList.add(tempList);
                }
                for (int i = 0; i < num_of_group; i++) {
                    int value = i * qty_days;
                    for (int j = 1; j <= qty_days + i; j++) {
                        (dataList.get(i)).add(timerange.get((j - 1) + value));
                    }
                }
                (dataList.get(num_of_group - 1)).remove(0);
                for (List<String> s : dataList) {
                    System.out.println(s);
                }
            }

            br.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static LocalDate dateInput(String userInput) {
        DateTimeFormatter dateFormat = DateTimeFormatter.ofPattern("M/d/yyyy");
        LocalDate date = LocalDate.parse(userInput, dateFormat);
        return date;
    }

    public static boolean isContain(String source, String subItem) {
        String pattern = "\\b" + subItem + "\\b";
        Pattern p = Pattern.compile(pattern);
        Matcher m = p.matcher(source);
        return m.find();
    }
}

class Data {
    // Data Fields
    String country, continent;
    static String[] timeRange = { "n", "m" };
    Scanner sc = new Scanner(System.in);

    // Constructors
    public Data() {
    }

    public Data(String country, String continent, String[] timeRange) {
        this.country = country;
        this.continent = continent;
        Data.timeRange = timeRange;
    }

    // Methods
    public void inputArea() {
        System.out.println("Select your country or continent: ");
        String option = sc.nextLine();
        if (option.equals("country")) {
            System.out.println("Input your country: ");
            country = sc.nextLine();
        } else if (option.equals("continent")) {
            System.out.println("Input your continent: ");
            continent = sc.nextLine();
        } else {
            System.out.println("Invalid option");
            inputArea();
        }
    }

    public void timeRangeType() {
        int option;
        System.out.println("""
                Choose your time range:
                1. Pair
                2. Number of days or weeks from a particular date
                3. Number of days or weeks to a particular date""");
        option = sc.nextInt();
        switch (option) {
            case 1:
                Method1();
                break;
            case 2:
                Method2();
                break;
            case 3:
                Method3();
                break;
        }
    }

    public static void Method1() {
        int year, month, day, year1, month1, day1;
        Scanner s = new Scanner(System.in);
        System.out.println("Start year: ");
        year = s.nextInt();
        System.out.println("Start month: ");
        month = s.nextInt();
        System.out.println("Start date: ");
        day = s.nextInt();

        System.out.println("End year: ");
        year1 = s.nextInt();
        System.out.println("End month: ");
        month1 = s.nextInt();
        System.out.println("End date: ");
        day1 = s.nextInt();

        LocalDate startDate = LocalDate.of(year, month, day);
        LocalDate endDate = LocalDate.of(year1, month1, day1);

        if (startDate.isBefore(endDate) == true) {
            System.out.println("Your start date is: " + startDate + " and your end date is: " + endDate);
        } else {
            System.out.println("Invalid Input!");
        }
    }

    public void Method2() {
        int year, month, day, days_of_month;
        Scanner s = new Scanner(System.in);
        System.out.println("Start year: ");
        year = s.nextInt();
        System.out.println("Start month: ");
        month = s.nextInt();
        System.out.println("Start date: ");
        day = s.nextInt();

        LocalDate startDate = LocalDate.of(year, month, day);
        LocalDate endDate = LocalDate.of(year, month, day);

        System.out.println("Enter your days will stay: ");
        days_of_month = s.nextInt();
        endDate = startDate.plusDays(days_of_month);
        System.out.println("Your start date is: " + startDate + " and your end date is: " + endDate);
    }

    public void Method3() {
        int year, month, day, days_of_month;
        Scanner s = new Scanner(System.in);
        System.out.println("End year: ");
        year = s.nextInt();
        System.out.println("End month: ");
        month = s.nextInt();
        System.out.println("End date: ");
        day = s.nextInt();

        LocalDate startDate = LocalDate.of(year, month, day);
        LocalDate endDate = LocalDate.of(year, month, day);

        System.out.println("Enter your days will stay: ");
        days_of_month = s.nextInt();
        startDate = endDate.minusDays(days_of_month);
        System.out.println("Your start date is: " + startDate + " and your end date is: " + endDate);
    }
}
